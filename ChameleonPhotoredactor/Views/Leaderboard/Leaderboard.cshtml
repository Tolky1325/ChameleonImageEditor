@model List<ChameleonPhotoredactor.Models.ViewModels.Leaderboard.LeaderboardViewModel>

@{
    ViewData["Title"] = "Community Leaderboard";
    Layout = "~/Views/Shared/_LayoutLeaderboard.cshtml";

    var currentUser = ViewBag.CurrentUserRanking as ChameleonPhotoredactor.Models.ViewModels.Leaderboard.LeaderboardViewModel;
}

@{
    string currentSort = ViewBag.Sort as string ?? "";
    string currentDir = ViewBag.Direction as string ?? "desc";

    string NextDirection(string col)
    {
        if (currentSort == col)
            return currentDir == "asc" ? "desc" : "asc";
        return "desc";
    }

    string SortIcon(string col)
    {
        if (currentSort != col)
            return "";

        return currentDir == "asc"
            ? "<span class=\"material-symbols-outlined\">arrow_drop_up</span>"
            : "<span class=\"material-symbols-outlined\">arrow_drop_down</span>";
    }
}


<div class="content-container_stats">

    <div class="bottom_stats">

        <div class="title-stats">
            <span class="material-symbols-outlined icon_image" style="font-size: 30px;">
                trophy
            </span>
            <h3>Community Leaderboard</h3>
        </div>

        <div class="search-container">
            <input type="text" id="leaderboardSearch" placeholder="Search username..." />
        </div>

        <div class="filter_stats">

            <a class="sorting_parameter @(currentSort == "imports" ? "active" : "")"
               href="/Leaderboard/Leaderboard?sort=imports&direction=@NextDirection("imports")">
                Imports @Html.Raw(SortIcon("imports"))
            </a>

            <a class="sorting_parameter @(currentSort == "edits" ? "active" : "")"
               href="/Leaderboard/Leaderboard?sort=edits&direction=@NextDirection("edits")">
                Edits @Html.Raw(SortIcon("edits"))
            </a>

            <a class="sorting_parameter @(currentSort == "exported" ? "active" : "")"
               href="/Leaderboard/Leaderboard?sort=exported&direction=@NextDirection("exported")">
                Exported @Html.Raw(SortIcon("exported"))
            </a>

        </div>


    </div>

    <div class="user_stats_all">
        @if (Model.Any())
        {
            @foreach (var item in Model)
            {
                <div class="ranking-row @(item.Rank == 1 ? "rank-one" : "")">

                    <div class="rank-col @(item.Rank <= 3 ? "top-rank" : "")">
                        <span class="rank-number">@item.Rank</span>
                        @if (item.Rank == 1)
                        {
                            <span class="material-symbols-outlined crown-icon">crown</span>
                        }
                    </div>

                    <div class="user-icon_container">

                        <span class="material-symbols-outlined user-icon">person</span>
                    </div>

                    <div class="nickname-col">
                        <span class="nickname-text">@item.Username</span>
                    </div>

                    <div class="stats-col">

                        <div class="iports_stat-value">
                            <span class="stat-value">@item.Imports</span>
                        </div>

                        <div class ="edits_stat-value">
                            <span class="stat-value">@item.Edits</span>
                        </div>

                        <div class="exports_stat-value">
                            <span class="stat-value">@item.Exported</span>
                        </div>

                    </div>
                </div>
            }
        }
        else
        {
            <p style="text-align: center; padding: 20px;">
                The leaderboard is currently empty. Be the first!
            </p>
        }
    </div>

    @if (currentUser != null && currentUser.Rank > Model.Count())
    {
        <h3 class="your-ranking-header">Your ranking</h3>

        <div class="ranking-row your-ranking-row">
            <div class="rank-col">
                <span class="rank-number">@currentUser.Rank</span>
            </div>

            <div class="nickname-col">
                <span class="material-symbols-outlined user-icon">person</span>
                <span class="nickname-text">@currentUser.Username</span>
            </div>

            <div class="stats-col">
                <span class="stat-value">@currentUser.Imports</span>
                <span class="stat-value">@currentUser.Edits</span>
                <span class="stat-value">@currentUser.Exported</span>
            </div>
        </div>
    }

    <div class="user_stats_container">
        <div class="lable_user_stats">
            <h4>Your ranking</h4>
        </div>
        <div class="user_stats">
            @if (currentUser != null)
            {
                <div class="ranking-row your-ranking-row">
                    <div class="rank-col @(currentUser.Rank <= 3 ? "top-rank" : "")">
                        <span class="rank-number">@currentUser.Rank</span>
                        @if (currentUser.Rank == 1)
                        {
                            <span class="material-symbols-outlined crown-icon">crown</span>
                        }
                    </div>

                    <div class="user-icon_container">
                        <span class="material-symbols-outlined user-icon">person</span>
                    </div>

                    <div class="nickname-col your_nickname-col">
                        <span class="nickname-text">@currentUser.Username</span>
                    </div>

                    <div class="stats-col">
                        <div class="iports_stat-value">
                            <span class="stat-value">@currentUser.Imports</span>
                        </div>
                        <div class="edits_stat-value">
                            <span class="stat-value">@currentUser.Edits</span>
                        </div>
                        <div class="exports_stat-value">
                            <span class="stat-value">@currentUser.Exported</span>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>

    

</div>