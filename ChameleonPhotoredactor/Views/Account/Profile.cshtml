@model ChameleonPhotoredactor.Models.Entities.User

@{
    ViewData["Title"] = "Profile Page";
    Layout = "~/Views/Shared/_LayoutProfile.cshtml";
}

<div class="content-container_profile">
    <img src="~/images/Font-Shapes/Authorization-circle.svg" class="shape shape9" />
    <img src="~/images/Font-Shapes/Authorization-circle2.svg" class="shape shape10" />
    <img src="~/images/Font-Shapes/Authorization-circle.svg" class="shape shape11" />

    <div class="bottom_profile">
        <div class="bottom_info-container">
            <h4>Manage your account settings and view your statistics</h4>
        </div>

        <div class="button-import-container">
            <form asp-controller="Account" asp-action="Signout" method="post">
                <input type="file" id="fileInput" name="file" style="display:none;" accept="image/*" />

                <button class="profile_button-sign_out" type="submit" id="uploadBtn">
                    <span class="text-import_a">Sign Out</span>
                    <span class="material-symbols-outlined icon_upload">logout</span>
                </button>
            </form>
        </div>
    </div>

    <div class="profil_information">
        <div class="profile-info_container">

            <div class="avatar-username_container">
                <div class="avatar-container">
                    @if (Model.userProfilePic != null && Model.userProfilePic.Length > 0)
                    {
                        <img src="data:image/png;base64,@Convert.ToBase64String(Model.userProfilePic)" alt="Avatar" style="width:100%; height:100%; object-fit:cover; border-radius:50%;" />
                    }
                    else
                    {
                        <span class="material-symbols-outlined icon_upload" style="font-size: 50px;">person</span>
                    }

                    <a class="icon_camera_container" id="cameraIconContainer">
                        <span class="material-symbols-outlined icon_camera" style="font-size: 22px;">
                            photo_camera
                        </span>
                    </a>
                </div>



                <div class="profile_container username-info_container">
                    <div class="label">Username</div>
                    <div class="user_info">@Model.userName</div>
                </div>
            </div>

            <div class="profile_container displae-name-info_container">
                <div class="label">Display Name</div>
                <div class="user_info user_info-view" id="displayNameView">@Model.userDisplayName</div>
                <input type="text" class="user_info user_info-edit" id="displayNameEdit" value="@Model.userDisplayName" style="display:none;" />
            </div>

            <div class="profile_container email-info_container">
                <div class="label">Email</div>
                <div class="user_info user_info-view" id="emailView">@Model.userEmail</div>
                <input type="email" class="user_info user_info-edit" id="emailEdit" value="@Model.userEmail" style="display:none;" />
            </div>

            <div class="profile_container member-since-info_container">
                <div class="label">Member since</div>
                <div class="user_info">@Model.userCreationDate.ToString("d")</div>
            </div>

            <div class="btn_edit-profile_container">
                <a class="btn_edit-profile" id="editProfileBtn">
                    Edit Profile
                    <span class="material-symbols-outlined icon_upload" style="font-size: 24px;">edit</span>
                </a>
                <a class="btn_edit-profile" id="saveProfileBtn" style="display:none; margin-right: 10px;">
                    Save Changes
                    <span class="material-symbols-outlined icon_upload" style="font-size: 24px;">save</span>
                </a>
                <a class="btn_edit-profile" id="cancelEditBtn" style="display:none;">
                    Cancel
                    <span class="material-symbols-outlined icon_upload" style="font-size: 24px;">close</span>
                </a>
            </div>
        </div>

        <div class="metrics-info_container">
            <h3>Your Statistics</h3>

            <div class="metric_block">
                <span class="material-symbols-outlined icon_upload" style="font-size: 24px;">upload</span>
                <div class="metric_label">Imported</div>
                <div class="metric_value">@(Model.UserStats?.importCount ?? 0)</div>
            </div>

            <div class="metric_block">
                <span class="material-symbols-outlined icon_upload discover_tune-rotate" style="font-size: 24px;">discover_tune</span>
                <div class="metric_label">Edited</div>
                <div class="metric_value">@(Model.UserStats?.editCount ?? 0)</div>
            </div>

            <div class="metric_block">
                <span class="material-symbols-outlined icon_upload" style="font-size: 24px;">download</span>
                <div class="metric_label">Exported</div>
                <div class="metric_value">@(Model.UserStats?.exportCount ?? 0)</div>
            </div>

            <a class="delete_account_block" id="deleteAccount" href="javascript:void(0);" onclick="confirmDelete()">
                <div class="delete_account_label">Delete Account</div>
                <span class="material-symbols-outlined icon_delete_account" style="font-size: 24px;">delete</span>
            </a>

            
        </div>
    </div>
    <form id="deleteAccountForm" asp-controller="Account" asp-action="DeleteAccount" method="post" style="display:none;">
        @Html.AntiForgeryToken()
    </form>
</div>
@section Scripts {
    <script>
        function confirmDelete() {
            if (confirm("Are you sure you want to delete your account? This action cannot be undone and you will lose all your saved images.")) {
                document.getElementById('deleteAccountForm').submit();
            }
        }
    </script>

    <script src="~/js/profile.js"></script>
}